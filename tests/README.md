# Athena Trader æµ‹è¯•ç›®å½•

## ç›®å½•ç»“æ„

```
tests/
â”œâ”€â”€ README.md                   # æœ¬æ–‡æ¡£
â”œâ”€â”€ conftest.py                # pytesté…ç½®
â”œâ”€â”€ run_all_tests.py           # æµ‹è¯•è¿è¡Œå™¨
â”œâ”€â”€ test_okx_api.py            # OKX APIæµ‹è¯•
â”œâ”€â”€ test_security_fixes.py      # å®‰å…¨ä¿®å¤æµ‹è¯•
â”œâ”€â”€ unit/                      # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ data_manager/          # æ•°æ®ç®¡ç†å™¨å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ executor/              # æ‰§è¡Œå™¨å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ risk_manager/          # é£é™©ç®¡ç†å™¨å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ strategy_engine/        # ç­–ç•¥å¼•æ“å•å…ƒæµ‹è¯•
â”‚   â””â”€â”€ utils/                 # å·¥å…·ç±»å•å…ƒæµ‹è¯•
â”œâ”€â”€ integration/               # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ test_account_balance.py
â”‚   â”œâ”€â”€ test_api_endpoint.py
â”‚   â”œâ”€â”€ test_data_manager_service.py
â”‚   â”œâ”€â”€ test_data_manager.py
â”‚   â”œâ”€â”€ test_microservices.py
â”‚   â”œâ”€â”€ test_mock_data.py
â”‚   â”œâ”€â”€ test_network_connectivity.py
â”‚   â”œâ”€â”€ test_okx_connection.py
â”‚   â”œâ”€â”€ test_strategy_api.py
â”‚   â””â”€â”€ test_strategy_auth.py
â”œâ”€â”€ system/                    # ç³»ç»Ÿæµ‹è¯•
â”‚   â”œâ”€â”€ simple_trading_test.py
â”‚   â”œâ”€â”€ simple_trading_test_fixed.py
â”‚   â””â”€â”€ test_fixes_verification.py
â”œâ”€â”€ performance/               # æ€§èƒ½æµ‹è¯•
â”‚   â””â”€â”€ test_metrics_performance.py
â”œâ”€â”€ debug/                     # è°ƒè¯•å’Œæ‰‹åŠ¨æµ‹è¯•å·¥å…·
â”‚   â”œâ”€â”€ debug_history.py
â”‚   â”œâ”€â”€ test_executor_injection.py
â”‚   â”œâ”€â”€ test_manual_trade.py
â”‚   â”œâ”€â”€ test_websocket_fix.py
â”‚   â”œâ”€â”€ verify_data_feed_mock.py
â”‚   â”œâ”€â”€ verify_data_feed.py
â”‚   â””â”€â”€ verify_environment_config.py
â”œâ”€â”€ manual/                    # æ‰‹åŠ¨æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ test_heartbeat.py      # å¿ƒè·³æœºåˆ¶æµ‹è¯•
â”œâ”€â”€ reports/                   # æµ‹è¯•æŠ¥å‘Š
â”‚   â”œâ”€â”€ benchmarks/            # åŸºå‡†æµ‹è¯•æŠ¥å‘Š
â”‚   â”œâ”€â”€ coverage/              # ä»£ç è¦†ç›–ç‡æŠ¥å‘Š
â”‚   â””â”€â”€ html/                 # HTMLæµ‹è¯•æŠ¥å‘Š
â””â”€â”€ utils/                     # æµ‹è¯•å·¥å…·
    â””â”€â”€ base_test_runner.py    # æµ‹è¯•è¿è¡Œå™¨åŸºç±»
```

## æµ‹è¯•åˆ†ç±»

### ğŸ”¬ å•å…ƒæµ‹è¯• (unit/)
æµ‹è¯•å•ä¸ªå‡½æ•°ã€ç±»æˆ–æ¨¡å—çš„åŠŸèƒ½
- æ¯ä¸ªæœåŠ¡æ¨¡å—éƒ½æœ‰å¯¹åº”çš„å•å…ƒæµ‹è¯•ç›®å½•
- ä½¿ç”¨ pytest æ¡†æ¶
- å¿«é€Ÿæ‰§è¡Œï¼Œéš”ç¦»æµ‹è¯•

### ğŸ”— é›†æˆæµ‹è¯• (integration/)
æµ‹è¯•å¤šä¸ªæ¨¡å—æˆ–æœåŠ¡ä¹‹é—´çš„åä½œ
- APIç«¯ç‚¹æµ‹è¯•
- æœåŠ¡é—´é€šä¿¡æµ‹è¯•
- æ•°æ®åº“é›†æˆæµ‹è¯•
- å¤–éƒ¨APIé›†æˆæµ‹è¯•

### ğŸ–¥ï¸ ç³»ç»Ÿæµ‹è¯• (system/)
æµ‹è¯•æ•´ä¸ªç³»ç»Ÿçš„ç«¯åˆ°ç«¯åŠŸèƒ½
- å®Œæ•´äº¤æ˜“æµç¨‹æµ‹è¯•
- å¤šæœåŠ¡åä½œæµ‹è¯•
- çœŸå®ç¯å¢ƒæ¨¡æ‹Ÿæµ‹è¯•

### âš¡ æ€§èƒ½æµ‹è¯• (performance/)
æµ‹è¯•ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡
- å“åº”æ—¶é—´æµ‹è¯•
- å¹¶å‘æ€§èƒ½æµ‹è¯•
- èµ„æºä½¿ç”¨æµ‹è¯•

### ğŸ› è°ƒè¯•å·¥å…· (debug/)
å¼€å‘é˜¶æ®µä½¿ç”¨çš„è°ƒè¯•å’ŒéªŒè¯å·¥å…·
- åŠŸèƒ½éªŒè¯è„šæœ¬
- é—®é¢˜è¯Šæ–­å·¥å…·
- æ‰‹åŠ¨æµ‹è¯•è¾…åŠ©å·¥å…·

### âœ‹ æ‰‹åŠ¨æµ‹è¯• (manual/)
éœ€è¦äººå·¥å¹²é¢„æˆ–è§‚å¯Ÿçš„æµ‹è¯•
- äº¤äº’å¼æµ‹è¯•
- å¯è§†åŒ–éªŒè¯æµ‹è¯•
- ç‰¹æ®Šåœºæ™¯æµ‹è¯•

## è¿è¡Œæµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
# ä½¿ç”¨æµ‹è¯•è¿è¡Œå™¨
python tests/run_all_tests.py

# ä½¿ç”¨pytest
pytest tests/

# ä½¿ç”¨ç»Ÿä¸€å¯åŠ¨è„šæœ¬
python scripts/start.py test
```

### è¿è¡Œç‰¹å®šç±»å‹æµ‹è¯•
```bash
# å•å…ƒæµ‹è¯•
pytest tests/unit/

# é›†æˆæµ‹è¯•
pytest tests/integration/

# ç³»ç»Ÿæµ‹è¯•
pytest tests/system/

# æ€§èƒ½æµ‹è¯•
pytest tests/performance/
```

### è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
```bash
# å•ä¸ªæ–‡ä»¶
pytest tests/test_okx_api.py

# ç‰¹å®šåŠŸèƒ½æµ‹è¯•
pytest tests/integration/test_data_manager.py

# è°ƒè¯•å·¥å…·
python tests/debug/test_websocket_fix.py

# æ‰‹åŠ¨æµ‹è¯•
python tests/manual/test_heartbeat.py
```

## æµ‹è¯•é…ç½®

### ç¯å¢ƒå˜é‡
- `ATHENA_ENV=test` - æµ‹è¯•ç¯å¢ƒæ ‡è¯†
- `USE_MOCK_DATA=true` - ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
- `DISABLE_REDIS=true` - ç¦ç”¨Redis
- `TEST_DATABASE_URL` - æµ‹è¯•æ•°æ®åº“URL

### é…ç½®æ–‡ä»¶
- `config/test.json` - æµ‹è¯•ç¯å¢ƒé…ç½®
- `pytest.ini` - pytesté…ç½®
- `.env.test` - æµ‹è¯•ç¯å¢ƒå˜é‡

### æµ‹è¯•æ•°æ®
- æµ‹è¯•æ•°æ®æ–‡ä»¶å­˜å‚¨åœ¨ `tests/fixtures/`
- æ¨¡æ‹Ÿæ•°æ®æ–‡ä»¶å­˜å‚¨åœ¨ `tests/mock_data/`

## è°ƒè¯•å·¥å…·è¯´æ˜

### test_websocket_fix.py
WebSocketè¿æ¥å’Œå¿ƒè·³æœºåˆ¶æµ‹è¯•
- éªŒè¯OKX WebSocketè¿æ¥
- æµ‹è¯•ping/pongå¿ƒè·³æœºåˆ¶
- æ£€æŸ¥é‡è¿é€»è¾‘

### verify_data_feed.py
æ•°æ®æºè¿æ¥éªŒè¯
- æµ‹è¯•OKX APIè¿æ¥
- éªŒè¯æ•°æ®è·å–åŠŸèƒ½
- æ£€æŸ¥æ•°æ®æ ¼å¼

### test_manual_trade.py
æ‰‹åŠ¨äº¤æ˜“æµ‹è¯•
- æ¨¡æ‹Ÿäº¤æ˜“ä¿¡å·
- æµ‹è¯•æ‰§è¡Œå™¨åŠŸèƒ½
- éªŒè¯é£é™©ç®¡ç†

## æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•å®Œæˆåä¼šç”Ÿæˆä»¥ä¸‹æŠ¥å‘Šï¼š
- `reports/html/index.html` - HTMLæ ¼å¼æµ‹è¯•æŠ¥å‘Š
- `reports/coverage/` - ä»£ç è¦†ç›–ç‡æŠ¥å‘Š
- `reports/benchmarks/` - æ€§èƒ½åŸºå‡†æŠ¥å‘Š

## æœ€ä½³å®è·µ

1. **ç¼–å†™æµ‹è¯•æ—¶**ï¼š
   - æ¯ä¸ªåŠŸèƒ½éƒ½è¦æœ‰å¯¹åº”çš„æµ‹è¯•
   - ä½¿ç”¨æ¸…æ™°çš„æµ‹è¯•æè¿°
   - éµå¾ªAAAæ¨¡å¼ï¼ˆArrange, Act, Assertï¼‰

2. **è¿è¡Œæµ‹è¯•å‰**ï¼š
   - ç¡®ä¿æµ‹è¯•ç¯å¢ƒé…ç½®æ­£ç¡®
   - æ¸…ç†ä¹‹å‰çš„æµ‹è¯•æ•°æ®
   - æ£€æŸ¥ä¾èµ–æœåŠ¡çŠ¶æ€

3. **è°ƒè¯•æµ‹è¯•**ï¼š
   - ä½¿ç”¨è°ƒè¯•å·¥å…·è¿›è¡Œé—®é¢˜å®šä½
   - æŸ¥çœ‹è¯¦ç»†çš„æµ‹è¯•æ—¥å¿—
   - ä½¿ç”¨æ–­ç‚¹è°ƒè¯•å¤æ‚é—®é¢˜

## è¿ç§»è¯´æ˜

ä»¥ä¸‹æ–‡ä»¶å·²ä»å…¶ä»–ç›®å½•è¿ç§»è‡³æ­¤ï¼š
- `scripts/debug_tools/*` â†’ `tests/debug/`
- `test_heartbeat.py` â†’ `tests/manual/`

## æ•…éšœæ’é™¤

1. **æµ‹è¯•å¤±è´¥**ï¼šæ£€æŸ¥ç¯å¢ƒé…ç½®å’Œä¾èµ–æœåŠ¡
2. **è¿æ¥è¶…æ—¶**ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAPIé…ç½®
3. **æƒé™é”™è¯¯**ï¼šç¡®ä¿æœ‰è¶³å¤Ÿçš„æ–‡ä»¶ç³»ç»Ÿæƒé™
4. **å†…å­˜ä¸è¶³**ï¼šå‡å°‘å¹¶å‘æµ‹è¯•æ•°é‡

## æ›´æ–°å†å²

- 2025-12-22: é‡æ–°ç»„ç»‡æµ‹è¯•ç›®å½•ç»“æ„
- 2025-12-22: æ·»åŠ  debug å’Œ manual ç›®å½•
- 2025-12-22: ç§»åŠ¨è°ƒè¯•å·¥å…·åˆ°ä¸“é—¨ç›®å½•
